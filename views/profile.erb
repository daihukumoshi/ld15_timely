<link rel="stylesheet" href="/assets/css/white.css">
<div class="whole">
<div>
    <h1><%= @the_user.display_name %>さんのタスク状況</h1>

    <% if Friend.find_by(following_id: session[:user], followed_id: @the_user.id) %>
        <form action='/<%= @the_user.id %>/unfollow' method='post'>
            <input type="submit" value="フォローをやめる" class="prfbutton">
        </form>
    <% else %>
        <form action='/<%= @the_user.id %>/follow' method='post'>
            <input type="submit" value="フォローする" class="prfbutton">
        </form>
    <% end %>
    <!--重複回避しなきゃまずい-->
</div>

<div class="task_box">
    <!--タスク取得してeach回す-->
    <% tasks = Task.where(user_id: @the_user.id) %>
    <% tasks.each do |task|%>
        <div>
            <a class="input_task"><%= task.task_name %></a>
            <a class="input_minutes"><%= task.minutes %></a>
            <% if Status.find_by(task_id: task.id, user_id: @the_user.id).nil? %>
                <a class="sta sta1">will</a>
            <% else %>
                <a class="sta">done</a>
            <% end %>
        </div>
    <% end %>
    
</div>

<div id="time_box">
    <% if Need.where(user_id: @the_user.id).nil? or Need.where(user_id: @the_user.id).empty? %>
        <p>まだ準備開始していません</p>
    <% else %>
        <% dt = Need.where(user_id: @the_user.id).last.pushtime %>
        <p>直近の準備開始時刻　　<%= dt.mon %>/<%= dt.day %>　<%= dt.hour.to_i + 9 %>:<%=dt.min %></p>
        
        <p>出発推定時刻　<%= time_arrivehour @the_user.id %></p>
        <p>到着推定時刻　<%= time_depart @the_user.id %></p>

    <% end %>
</div>
<div id="comment_input">
    <form action='/<%= @the_user.id %>/comment' method='post'>
        <input type="text" name="comment" id="comment" placeholder="コメントを入力">
        <input type="submit" value="コメント" class="prfbutton">
    </form>
    
</div>
</div>